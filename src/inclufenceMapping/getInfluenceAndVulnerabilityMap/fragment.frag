precision mediump float;

uniform sampler2D uInfluenceSample2;
uniform sampler2D uTensionSample2;

varying vec2 vUvs;

void main() {
  vec4 myInfluence = texture2D(uInfluenceSample2, vUvs);
  vec4 tensionMap = texture2D(uTensionSample2, vUvs);
  float influenceMap = -(tensionMap.g - 2.0 * myInfluence.r);
  // float influenceMap = 0.5 -(tensionMap.g - 2.0 * myInfluence.r) / 2.0;
// TODO: use alpha chanel somehow, read why alpha != 1 sets red channel to 255
  gl_FragColor = vec4(
    myInfluence.r,
    (tensionMap.b - myInfluence.b) * (tensionMap.g - myInfluence.r), // only enemy positions should be marked
    // TODO: we can use green chanel mroe useful, rn it's 0 or 1
    (tensionMap.g - abs(influenceMap)), // vulnerability
    1.0 // do not modify alpha, alpha < 1.0 changes red of channel to 255 in extract.pixels method
  );
}
